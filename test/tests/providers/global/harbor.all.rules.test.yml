---
rule_files:
  - harbor.all.rules.yml
tests:
  - interval: 1m
    input_series:
      - series: 'harbor_up{}'
        values: "_x5 1+0x5 0+0x5"
    alert_rule_test:
      - alertname: HarborDown
        eval_time: 5m
        exp_alerts:
          - exp_labels:
              severity: critical
              app: harbor
              cancel_if_apiserver_down: "true"
              cancel_if_cluster_status_creating: "true"
              cancel_if_cluster_status_deleting: "true"
              cancel_if_cluster_status_updating: "true"
              cancel_if_scrape_timeout: "true"
              cancel_if_outside_working_hours: "true"
            exp_annotations:
              description: " of job  has been down for more than 5 minutes."
              summary: " Instance  down."