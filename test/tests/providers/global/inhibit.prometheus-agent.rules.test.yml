---
rule_files:
  - inhibit.prometheus-agent.rules.yml

tests:
  - interval: 1m
    input_series:
      - series: 'prometheus_build_info{app="prometheus",cluster_id="gauss",instance="localhost:9090"}'
        values: "1+0x40"
      - series: 'kube_statefulset_created{namespace="kube-system",cluster_id="gauss",statefulset="prometheus-prometheus-agent"}'
        values: "1+0x20 0+0x20"
    alert_rule_test:
      - alertname: InhibitionClusterIsNotRunningPrometheusAgent
        eval_time: 1m
      - alertname: InhibitionClusterIsNotRunningPrometheusAgent
        eval_time: 22m
        exp_alerts:
          - exp_labels:
              area: empowerment
              team: atlas
              topic: monitoring
              cluster_is_not_running_prometheus_agent: "true"
              cluster_id: "gauss"
            exp_annotations:
              description: "Cluster (gauss) is not running Prometheus Agent."

