---
rule_files:
  - inhibit.prometheus-agent.rules.yml

tests:
  - interval: 1m
    input_series:
      - series: 'app_operator_app_info{app="observability-bundle",status="deployed",name="test2-observability-bundle",cluster_id="gauss",version="1.1.0"}'
        values: "1+0x20 0+0x100"
      - series: 'kube_namespace_created{namespace="test1-prometheus",name="prometheus-test1"}'
        values: "1+0x20 0+0x100"
    alert_rule_test:
      - alertname: InhibitionClusterIsNotRunningPrometheusAgent
        eval_time: 1m
        exp_alerts:
          - exp_labels:
              area: empowerment
              team: atlas
              topic: monitoring
              cluster_is_not_running_prometheus_agent: "true"
              cluster_id: "test1"
            exp_annotations:
              description: "Cluster (test1) is not running Prometheus Agent."
